!function(e){var t={};function o(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(n,a,function(t){return e[t]}.bind(null,a));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=29)}([function(e,t){!function(){e.exports=this.wp.element}()},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t){!function(){e.exports=this.wp.autop}()},function(e,t,o){var n;
/*!
  Copyright (c) 2016 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/!function(){"use strict";var o={}.hasOwnProperty;function a(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var r=typeof n;if("string"===r||"number"===r)e.push(n);else if(Array.isArray(n))e.push(a.apply(null,n));else if("object"===r)for(var l in n)o.call(n,l)&&n[l]&&e.push(l)}}return e.join(" ")}e.exports?e.exports=a:void 0===(n=function(){return a}.apply(t,[]))||(e.exports=n)}()},function(e,t,o){var n=o(16).Symbol;e.exports=n},function(e,t){function o(t){return e.exports=o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},o(t)}e.exports=o},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function o(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}e.exports=function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}},function(e,t,o){var n=o(12);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}},function(e,t,o){var n=o(13),a=o(1);e.exports=function(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?a(e):t}},function(e,t){!function(){e.exports=this.lodash}()},function(e,t,o){var n=o(14),a=o(26),r=/&(?:amp|lt|gt|quot|#39);/g,l=RegExp(r.source);e.exports=function(e){return(e=n(e))&&l.test(e)?e.replace(r,a):e}},function(e,t){function o(t,n){return e.exports=o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},o(t,n)}e.exports=o},function(e,t){function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(t){return"function"==typeof Symbol&&"symbol"===o(Symbol.iterator)?e.exports=n=function(e){return o(e)}:e.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":o(e)},n(t)}e.exports=n},function(e,t,o){var n=o(15);e.exports=function(e){return null==e?"":n(e)}},function(e,t,o){var n=o(4),a=o(19),r=o(20),l=o(21),s=n?n.prototype:void 0,i=s?s.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(r(t))return a(t,e)+"";if(l(t))return i?i.call(t):"";var o=t+"";return"0"==o&&1/t==-1/0?"-0":o}},function(e,t,o){var n=o(17),a="object"==typeof self&&self&&self.Object===Object&&self,r=n||a||Function("return this")();e.exports=r},function(e,t,o){(function(t){var o="object"==typeof t&&t&&t.Object===Object&&t;e.exports=o}).call(this,o(18))},function(e,t){var o;o=function(){return this}();try{o=o||new Function("return this")()}catch(e){"object"==typeof window&&(o=window)}e.exports=o},function(e,t){e.exports=function(e,t){for(var o=-1,n=null==e?0:e.length,a=Array(n);++o<n;)a[o]=t(e[o],o,e);return a}},function(e,t){var o=Array.isArray;e.exports=o},function(e,t,o){var n=o(22),a=o(25);e.exports=function(e){return"symbol"==typeof e||a(e)&&"[object Symbol]"==n(e)}},function(e,t,o){var n=o(4),a=o(23),r=o(24),l=n?n.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":l&&l in Object(e)?a(e):r(e)}},function(e,t,o){var n=o(4),a=Object.prototype,r=a.hasOwnProperty,l=a.toString,s=n?n.toStringTag:void 0;e.exports=function(e){var t=r.call(e,s),o=e[s];try{e[s]=void 0;var n=!0}catch(e){}var a=l.call(e);return n&&(t?e[s]=o:delete e[s]),a}},function(e,t){var o=Object.prototype.toString;e.exports=function(e){return o.call(e)}},function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},function(e,t,o){var n=o(27)({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});e.exports=n},function(e,t){e.exports=function(e){return function(t){return null==e?void 0:e[t]}}},,function(e,t,o){"use strict";o.r(t);var n={};o.r(n),o.d(n,"name",(function(){return re})),o.d(n,"settings",(function(){return le}));var a=o(6),r=o.n(a),l=o(7),s=o.n(l),i=o(1),c=o.n(i),d=o(8),u=o.n(d),p=o(9),w=o.n(p),f=o(5),h=o.n(f),m=o(0),b=o(10),y=o(3),g=o.n(y),v=wp.element.RawHTML,O=function(e){var t=e.showThumbnails,o=e.image;return t&&o?Object(m.createElement)(v,{className:"edd_download_image"},o):null},j=o(11),_=o.n(j),E=wp.i18n.__,C=wp.element.Fragment;function x(e){return e?_()(e).trim():E("(Untitled)")}var D=function(e){var t=e.link,o=e.title,n=e.className,a=e.showCount,r=e.count,l=e.type;return"tag"===l||"category"===l?Object(m.createElement)(C,null,Object(m.createElement)("div",{className:"edd-download-term-title"},Object(m.createElement)("h3",{className:n},Object(m.createElement)("a",{href:t,target:"_blank"},x(o))),a&&Object(m.createElement)("span",{className:"edd-download-term-count"},"(",r,")"))):Object(m.createElement)(C,null,Object(m.createElement)("h3",{className:n},Object(m.createElement)("a",{href:t,target:"_blank"},x(o))))},S=o(2),T=wp.element.RawHTML,k=function(e){var t=e.description,o=e.showDescription,n=e.className;return o?Object(m.createElement)(T,{className:n},Object(S.autop)(t)):null},B=wp.element.RawHTML,N=function(e){var t=e.content,o=e.showFullContent,n=e.className;return o?Object(m.createElement)(B,{className:n},Object(S.autop)(t)):null},A=wp.element.RawHTML,P=function(e){var t=e.price;return e.showPrice?Object(m.createElement)("div",{className:"edd_price"},Object(m.createElement)(A,null,t)):null},R=wp.element.RawHTML,L=wp.components.Disabled,F=function(e){var t=e.purchaseLink;return e.showBuyButton?Object(m.createElement)(L,null,Object(m.createElement)("div",{className:"edd_download_buy_button"},Object(m.createElement)(R,null,t))):null},q=function(e){var t=e.attributes,o=t.showThumbnails,n=t.showDescription,a=t.showFullContent,r=t.showPrice,l=t.showBuyButton,s=e.download.info,i=s.image,c=s.link,d=s.title,u=s.excerpt,p=s.content,w=s.price,f=s.purchase_link;return Object(m.createElement)("div",{className:"edd_download"},Object(m.createElement)("div",{className:"edd_download_inner"},Object(m.createElement)(O,{image:i,showThumbnails:o}),Object(m.createElement)(D,{title:d,link:c,className:"edd_download_title"}),Object(m.createElement)(k,{description:u,showDescription:n,className:"edd_download_excerpt"}),Object(m.createElement)(N,{content:p,showFullContent:a,className:"edd_download_full_content"}),Object(m.createElement)(P,{price:w,showPrice:r}),Object(m.createElement)(F,{purchaseLink:f,showBuyButton:l})))},M=function(e){var t,o=e.attributes,n=o.showThumbnails,a=o.showTitle,r=o.showCount,l=o.showDescription,s=e.taxonomy,i=s.name,c=s.link,d=s.count,u=s.description,p=s.taxonomy,w=e.taxonomy.meta.image;return"download_tag"===p?t="tag":"download_category"===p&&(t="category"),Object(m.createElement)("div",{className:"edd-download-".concat(t)},Object(m.createElement)(O,{image:w,showThumbnails:n}),a&&Object(m.createElement)(D,{title:i,link:c,className:"edd_download_title",showCount:r,count:d,type:"".concat(t)}),l&&Object(m.createElement)(k,{description:u,showDescription:l,className:"edd-download-term-description"}))};function H(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=h()(e);if(t){var a=h()(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return w()(this,o)}}var U=wp.element,I=U.Component,W=U.Fragment,z=wp.components,G=z.PanelBody,J=z.Placeholder,K=z.ToggleControl,Q=z.RangeControl,V=z.SelectControl,X=z.Spinner,Y=wp.i18n.__,Z=(wp.data.select,wp.editor),$=Z.InspectorControls,ee=Z.BlockControls,te=Z.BlockAlignmentToolbar,oe=wp.apiFetch,ne=function(e){u()(o,e);var t=H(o);function o(){var e;return r()(this,o),(e=t.apply(this,arguments)).setDownloadCategory=e.setDownloadCategory.bind(c()(e)),e.showDescription=e.showDescription.bind(c()(e)),e.showFullContent=e.showFullContent.bind(c()(e)),e.state={isLoading:!0,showDescription:!0,showFullContent:!1,downloads:[],downloadCategories:[],downloadTags:[]},e}return s()(o,[{key:"componentDidMount",value:function(){var e=this.props.attributes.type;"downloads"===e&&(this.fetchDownloads(),this.fetchDownloadTaxonomy({taxonomy:"download_category"})),"download_categories"===e&&this.fetchDownloadTaxonomy({taxonomy:"download_category"}),"download_tags"===e&&this.fetchDownloadTaxonomy({taxonomy:"download_tag"})}},{key:"componentDidUpdate",value:function(e){var t=this.props.attributes,o=t.category,n=t.number,a=t.order,r=t.orderBy,l=t.showEmpty,s=t.type,i=wp.data.select("core/editor").getEditorSettings().alignWide,c=e.attributes;"downloads"===s&&(o===c.category&&n===c.number&&a===c.order&&r===c.orderBy||this.fetchDownloads(),"downloads"!==c.type&&(this.fetchDownloads(),l||this.fetchDownloadTaxonomy({taxonomy:"download_category"}),this.props.setAttributes({orderBy:"date"}))),"download_categories"===s&&(l===c.showEmpty&&a===c.order&&r===c.orderBy||this.fetchDownloadTaxonomy({taxonomy:"download_category"}),"download_categories"!==c.type&&(this.fetchDownloadTaxonomy({taxonomy:"download_category"}),this.props.setAttributes({orderBy:"count"}))),"download_tags"===s&&(l===c.showEmpty&&a===c.order&&r===c.orderBy||this.fetchDownloadTaxonomy({taxonomy:"download_tag"}),"download_tags"!==c.type&&(this.fetchDownloadTaxonomy({taxonomy:"download_tag"}),this.props.setAttributes({orderBy:"count"}))),i||this.props.setAttributes({align:void 0})}},{key:"componentWillUnmount",value:function(){delete this.downloadsRequest,delete this.downloadCategoriesRequest,delete this.downloadTagsRequest}},{key:"getOrderOptions",value:function(){return[{value:"ASC",label:Y("Ascending")},{value:"DESC",label:Y("Descending")}]}},{key:"getOrderByOptions",value:function(){var e,t=this.props.attributes.type;return"downloads"===t?e=[{value:"date",label:Y("Date Created")},{value:"earnings",label:Y("Earnings")},{value:"id",label:Y("ID")},{value:"price",label:Y("Price")},{value:"random",label:Y("Random")},{value:"sales",label:Y("Sales")},{value:"name",label:Y("Slug")},{value:"title",label:Y("Title")}]:"download_categories"!==t&&"download_tags"!==t||(e=[{value:"count",label:Y("Count")},{value:"id",label:Y("ID")},{value:"name",label:Y("Name")},{value:"slug",label:Y("Slug")}]),e}},{key:"getDownloadCategories",value:function(){var e=this.state.downloadCategories,t=[{value:"all",label:Y("All")}];return e.forEach((function(e){t.push({label:e.name,value:e.id})})),t}},{key:"getBlockTypes",value:function(){return[{value:"downloads",label:Y("Downloads")},{value:"download_categories",label:Y("Download Categories")},{value:"download_tags",label:Y("Download Tags")}]}},{key:"setDownloadCategory",value:function(e){"all"===e&&(e=void 0),this.props.setAttributes({category:e})}},{key:"showDescription",value:function(){var e=this.state.showDescription;this.setState({showDescription:!e,showFullContent:e},(function(){this.props.setAttributes({showDescription:!e}),this.props.setAttributes({showFullContent:!1})}))}},{key:"showFullContent",value:function(){var e=this.state.showFullContent;this.setState({showFullContent:!e,showDescription:e},(function(){this.props.setAttributes({showFullContent:!e}),this.props.setAttributes({showDescription:!1})}))}},{key:"fetchDownloadTaxonomy",value:function(e){var t=this,o=this.props.attributes,n=o.showEmpty,a=o.order,r=o.orderBy,l=o.type,s=e.taxonomy,i=this.getOrderByOptions(),c={per_page:-1,orderby:e.orderBy?e.orderBy.toLowerCase():r.toLowerCase(),order:e.order?e.order.toLowerCase():a.toLowerCase()};("downloads"===l&&(c.orderby="name",c.order="asc"),"download_categories"===l||"download_tags"===l)&&(i.find((function(e){return e.value===r}))||(c.orderby="count"),c.hide_empty=!0!==n);var d=oe({path:"/wp/v2/".concat(s),data:c});"download_category"===s&&(d.then((function(e){t.downloadCategoriesRequest===d&&t.setState({downloadCategories:e,isLoading:!1})})),this.downloadCategoriesRequest=d),"download_tag"===s&&(d.then((function(e){t.downloadTagsRequest===d&&t.setState({downloadTags:e,isLoading:!1})})),this.downloadTagsRequest=d)}},{key:"fetchDownloads",value:function(){var e=this,t=this.getOrderByOptions(),o=this.props.attributes,n=o.category,a=o.number,r=o.order,l=o.orderBy,s=l;switch(s){case"id":s="ID";break;case"random":s="rand";break;default:s=l}var i={number:a,order:r,orderby:s};Object(b.isUndefined)(n)||(i.category=n);var c=edd_blocks_global_vars.url;t.find((function(e){return e.value===l}))||(i.orderby="date");var d=oe({url:"".concat(c,"/?edd-api=products"),data:i});d.then((function(t){e.downloadsRequest===d&&e.setState({downloads:t,isLoading:!1})})),this.downloadsRequest=d}},{key:"renderDownloads",value:function(){var e=this.state.downloads.products,t=this.state,o=t.downloadCategories,n=t.downloadTags,a=this.props.attributes,r=a.columns,l=a.type;return"downloads"===l?Object(m.createElement)("div",{className:g()("edd_downloads_list","edd_download_columns_"+r)},e.map((function(e){return Object(m.createElement)(q,{download:e,key:e.info.id.toString(),attributes:a})}))):"download_categories"===l?Object(m.createElement)("div",{className:g()("edd_downloads_list","edd-download-terms","edd_download_columns_"+r)},o.map((function(e){return Object(m.createElement)(M,{key:e.id,taxonomy:e,attributes:a})}))):"download_tags"===l?Object(m.createElement)("div",{className:g()("edd_downloads_list","edd-download-terms","edd_download_columns_"+r)},n.map((function(e){return Object(m.createElement)(M,{key:e.id,taxonomy:e,attributes:a})}))):void 0}},{key:"render",value:function(){var e,t,o=this.props,n=o.attributes,a=o.setAttributes,r=n.align,l=n.number,s=n.columns,i=n.showBuyButton,c=n.showPrice,d=n.showThumbnails,u=n.showDescription,p=n.showFullContent,w=n.showPagination,f=n.order,h=n.orderBy,b=n.category,y=n.type,g=n.showTitle,v=n.showCount,O=n.showEmpty,j=this.state,_=j.downloadTags,E=j.downloadCategories,C=j.isLoading,x=this.state.downloads.products,D="download_categories"===y||"download_tags"===y;if(e=Y("downloads"===y?"Show Excerpt":"download_categories"===y?"Show Category Description":"download_tags"===y?"Show Tag Description":"Show Description"),t=Y("download_categories"===y?"Loading download categories":"download_tags"===y?"Loading download tags":"Loading downloads"),C)return Object(m.createElement)(W,null,Object(m.createElement)(J,{icon:"download",label:t},Object(m.createElement)(X,null)));var S=Object(m.createElement)($,null,Object(m.createElement)(G,{title:Y("Settings")},Object(m.createElement)(V,{label:Y("Display"),value:y,options:this.getBlockTypes(),onChange:function(e){return a({type:e})}}),"downloads"===y&&Object(m.createElement)(Q,{label:Y("Downloads Per Page"),value:l,onChange:function(e){return a({number:e})},min:1,max:100}),Object(m.createElement)(Q,{label:Y("Columns"),value:s,onChange:function(e){return a({columns:e})},min:1,max:6}),"downloads"===y&&Object(m.createElement)(K,{label:Y("Show Buy Button"),checked:!!i,onChange:function(){return a({showBuyButton:!i})}}),"downloads"===y&&Object(m.createElement)(K,{label:Y("Show Price"),checked:!!c,onChange:function(){return a({showPrice:!c})}}),Object(m.createElement)(K,{label:Y("Show Thumbnails"),checked:!!d,onChange:function(){return a({showThumbnails:!d})}}),D&&Object(m.createElement)(K,{label:Y("download_categories"===y?"Show Category Name":"Show Tag Name"),checked:!!g,onChange:function(){return a({showTitle:!g})}}),Object(m.createElement)(K,{label:e,checked:!!u,onChange:this.showDescription}),g&&D&&Object(m.createElement)(K,{label:Y("Show Count"),checked:!!v,onChange:function(){return a({showCount:!v})}}),D&&Object(m.createElement)(K,{label:Y("download_categories"===y?"Show Empty Categories":"Show Empty Tags"),checked:!!O,onChange:function(){return a({showEmpty:!O})}}),"downloads"===y&&Object(m.createElement)(K,{label:Y("Show Full Content"),checked:!!p,onChange:this.showFullContent}),"downloads"===y&&Object(m.createElement)(K,{label:Y("Show Pagination"),checked:!!w,onChange:function(){return a({showPagination:!w})}}),Object(m.createElement)(V,{label:Y("Order By"),value:h,options:this.getOrderByOptions(),onChange:function(e){return a({orderBy:e})}}),Object(m.createElement)(V,{label:Y("Order"),value:f,options:this.getOrderOptions(),onChange:function(e){return a({order:e})}}),"downloads"===y&&Object(m.createElement)(V,{label:Y("Show Downloads From Category"),value:b,options:this.getDownloadCategories(),onChange:this.setDownloadCategory}))),T=Array.isArray(x)&&x.length,k=Array.isArray(_)&&_.length,B=Array.isArray(E)&&E.length;return T||"downloads"!==y?B||"download_categories"!==y?k||"download_tags"!==y?Object(m.createElement)(W,null,S,Object(m.createElement)(ee,null,Object(m.createElement)(te,{value:r,onChange:function(e){return a({align:e})},controls:["wide","full"]})),Object(m.createElement)("div",{className:this.props.className},this.renderDownloads())):Object(m.createElement)(W,null,S,Object(m.createElement)(J,{icon:"download",label:Y("Loading download tags")},Array.isArray(_)?Y("No download tags found."):Object(m.createElement)(X,null))):Object(m.createElement)(W,null,S,Object(m.createElement)(J,{icon:"download",label:Y("Loading download categories")},Array.isArray(E)?Y("No download categories found."):Object(m.createElement)(X,null))):Object(m.createElement)(W,null,S,Object(m.createElement)(J,{icon:"download",label:Y("Loading downloads")},Array.isArray(x)?Y("No downloads found."):Object(m.createElement)(X,null)))}}]),o}(I),ae=wp.i18n.__,re="easydigitaldownloads/downloads",le={title:ae("Downloads"),description:ae("Display Downloads, Categories and Tags from Easy Digital Downloads."),icon:"download",category:"widgets",keywords:[ae("downloads"),ae("edd")],supports:{html:!1,multiple:!0},getEditWrapperProps:function(e){var t=e.align;if(["wide","full"].includes(t))return{"data-align":t,"data-block-type":"easy-digital-downloads"}},edit:ne,save:function(){return null}},se=wp.blocks.registerBlockType;[n].forEach((function(e){var t=e.name,o=e.settings;se(t,o)}))}]);
//# sourceMappingURL=main.js.map