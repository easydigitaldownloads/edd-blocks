!function(e){var t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=30)}([function(e,t){!function(){e.exports=this.wp.element}()},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t){!function(){e.exports=this.wp.autop}()},function(e,t,o){var n;
/*!
  Copyright (c) 2016 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/!function(){"use strict";var o={}.hasOwnProperty;function r(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var a=typeof n;if("string"===a||"number"===a)e.push(n);else if(Array.isArray(n))e.push(r.apply(null,n));else if("object"===a)for(var l in n)o.call(n,l)&&n[l]&&e.push(l)}}return e.join(" ")}e.exports?e.exports=r:void 0===(n=function(){return r}.apply(t,[]))||(e.exports=n)}()},function(e,t,o){var n=o(17).Symbol;e.exports=n},function(e,t){function o(t){return e.exports=o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},o(t)}e.exports=o},function(e,t){e.exports=function(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function o(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}e.exports=function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}},function(e,t,o){var n=o(13);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}},function(e,t,o){var n=o(14),r=o(1);e.exports=function(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?r(e):t}},function(e,t){!function(){e.exports=this.lodash}()},function(e,t,o){var n=o(15),r=o(27),a=/&(?:amp|lt|gt|quot|#39);/g,l=RegExp(a.source);e.exports=function(e){return(e=n(e))&&l.test(e)?e.replace(a,r):e}},function(e,t){function o(t,n){return e.exports=o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},o(t,n)}e.exports=o},function(e,t){function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(t){return"function"==typeof Symbol&&"symbol"===o(Symbol.iterator)?e.exports=n=function(e){return o(e)}:e.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":o(e)},n(t)}e.exports=n},function(e,t,o){var n=o(16);e.exports=function(e){return null==e?"":n(e)}},function(e,t,o){var n=o(4),r=o(20),a=o(21),l=o(22),s=n?n.prototype:void 0,c=s?s.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(a(t))return r(t,e)+"";if(l(t))return c?c.call(t):"";var o=t+"";return"0"==o&&1/t==-1/0?"-0":o}},function(e,t,o){var n=o(18),r="object"==typeof self&&self&&self.Object===Object&&self,a=n||r||Function("return this")();e.exports=a},function(e,t,o){(function(t){var o="object"==typeof t&&t&&t.Object===Object&&t;e.exports=o}).call(this,o(19))},function(e,t){var o;o=function(){return this}();try{o=o||new Function("return this")()}catch(e){"object"==typeof window&&(o=window)}e.exports=o},function(e,t){e.exports=function(e,t){for(var o=-1,n=null==e?0:e.length,r=Array(n);++o<n;)r[o]=t(e[o],o,e);return r}},function(e,t){var o=Array.isArray;e.exports=o},function(e,t,o){var n=o(23),r=o(26);e.exports=function(e){return"symbol"==typeof e||r(e)&&"[object Symbol]"==n(e)}},function(e,t,o){var n=o(4),r=o(24),a=o(25),l=n?n.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":l&&l in Object(e)?r(e):a(e)}},function(e,t,o){var n=o(4),r=Object.prototype,a=r.hasOwnProperty,l=r.toString,s=n?n.toStringTag:void 0;e.exports=function(e){var t=a.call(e,s),o=e[s];try{e[s]=void 0;var n=!0}catch(e){}var r=l.call(e);return n&&(t?e[s]=o:delete e[s]),r}},function(e,t){var o=Object.prototype.toString;e.exports=function(e){return o.call(e)}},function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},function(e,t,o){var n=o(28)({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});e.exports=n},function(e,t){e.exports=function(e){return function(t){return null==e?void 0:e[t]}}},,function(e,t,o){"use strict";o.r(t);var n={};o.r(n),o.d(n,"name",(function(){return ie})),o.d(n,"settings",(function(){return ue}));var r=o(6),a=o.n(r),l=o(7),s=o.n(l),c=o(8),i=o.n(c),u=o(1),d=o.n(u),p=o(9),w=o.n(p),f=o(10),b=o.n(f),h=o(5),m=o.n(h),y=o(0),g=o(11),v=o(3),O=o.n(v),j=wp.element.RawHTML,_=function(e){var t=e.showThumbnails,o=e.image;return t&&o?Object(y.createElement)(j,{className:"edd_download_image"},o):null},E=o(12),C=o.n(E),x=wp.i18n.__,D=wp.element.Fragment;function S(e){return e?C()(e).trim():x("(Untitled)")}var k=function(e){var t=e.link,o=e.title,n=e.className,r=e.showCount,a=e.count,l=e.type;return"tag"===l||"category"===l?Object(y.createElement)(D,null,Object(y.createElement)("div",{className:"edd-download-term-title"},Object(y.createElement)("h3",{className:n},Object(y.createElement)("a",{href:t,target:"_blank"},S(o))),r&&Object(y.createElement)("span",{className:"edd-download-term-count"},"(",a,")"))):Object(y.createElement)(D,null,Object(y.createElement)("h3",{className:n},Object(y.createElement)("a",{href:t,target:"_blank"},S(o))))},T=o(2),P=wp.element.RawHTML,B=function(e){var t=e.description,o=e.showDescription,n=e.className;return o?Object(y.createElement)(P,{className:n},Object(T.autop)(t)):null},A=wp.element.RawHTML,N=function(e){var t=e.content,o=e.showFullContent,n=e.className;return o?Object(y.createElement)(A,{className:n},Object(T.autop)(t)):null},R=wp.element.RawHTML,L=function(e){var t=e.price;return e.showPrice?Object(y.createElement)("div",{className:"edd_price"},Object(y.createElement)(R,null,t)):null},F=wp.element.RawHTML,q=wp.components.Disabled,M=function(e){var t=e.purchaseLink;return e.showBuyButton?Object(y.createElement)(q,null,Object(y.createElement)("div",{className:"edd_download_buy_button"},Object(y.createElement)(F,null,t))):null},H=function(e){var t=e.attributes,o=t.showThumbnails,n=t.showDescription,r=t.showFullContent,a=t.showPrice,l=t.showBuyButton,s=e.download.info,c=s.image,i=s.link,u=s.title,d=s.excerpt,p=s.content,w=s.price,f=s.purchase_link;return Object(y.createElement)("div",{className:"edd_download"},Object(y.createElement)("div",{className:"edd_download_inner"},Object(y.createElement)(_,{image:c,showThumbnails:o}),Object(y.createElement)(k,{title:u,link:i,className:"edd_download_title"}),Object(y.createElement)(B,{description:d,showDescription:n,className:"edd_download_excerpt"}),Object(y.createElement)(N,{content:p,showFullContent:r,className:"edd_download_full_content"}),Object(y.createElement)(L,{price:w,showPrice:a}),Object(y.createElement)(M,{purchaseLink:f,showBuyButton:l})))},U=function(e){var t,o=e.attributes,n=o.showThumbnails,r=o.showTitle,a=o.showCount,l=o.showDescription,s=e.taxonomy,c=s.name,i=s.link,u=s.count,d=s.description,p=s.taxonomy,w=e.taxonomy.meta.image;return"download_tag"===p?t="tag":"download_category"===p&&(t="category"),Object(y.createElement)("div",{className:"edd-download-".concat(t)},Object(y.createElement)(_,{image:w,showThumbnails:n}),r&&Object(y.createElement)(k,{title:c,link:i,className:"edd_download_title",showCount:a,count:u,type:"".concat(t)}),l&&Object(y.createElement)(B,{description:d,showDescription:l,className:"edd-download-term-description"}))};function I(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function W(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?I(Object(o),!0).forEach((function(t){a()(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):I(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function Q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=m()(e);if(t){var r=m()(this).constructor;o=Reflect.construct(n,arguments,r)}else o=n.apply(this,arguments);return b()(this,o)}}var z=wp.element,G=z.Component,J=z.Fragment,K=wp.components,V=K.PanelBody,X=K.Placeholder,Y=K.ToggleControl,Z=K.RangeControl,$=K.SelectControl,ee=K.Spinner,te=wp.i18n.__,oe=(wp.data.select,wp.editor),ne=oe.InspectorControls,re=oe.BlockControls,ae=oe.BlockAlignmentToolbar,le=wp.apiFetch,se=function(e){w()(o,e);var t=Q(o);function o(){var e;return s()(this,o),(e=t.apply(this,arguments)).setDownloadCategory=e.setDownloadCategory.bind(d()(e)),e.showDescription=e.showDescription.bind(d()(e)),e.showFullContent=e.showFullContent.bind(d()(e)),e.state={isLoading:!0,showDescription:!0,showFullContent:!1,downloads:[],downloadCategories:[],downloadTags:[]},e}return i()(o,[{key:"componentDidMount",value:function(){var e=this.props.attributes.type;"downloads"===e&&(this.fetchDownloads(),this.fetchDownloadTaxonomy({taxonomy:"download_category"})),"download_categories"===e&&this.fetchDownloadTaxonomy({taxonomy:"download_category"}),"download_tags"===e&&this.fetchDownloadTaxonomy({taxonomy:"download_tag"})}},{key:"componentDidUpdate",value:function(e){var t=this.props.attributes,o=t.category,n=t.number,r=t.order,a=t.orderBy,l=t.showEmpty,s=t.type,c=wp.data.select("core/editor").getEditorSettings().alignWide,i=e.attributes;"downloads"===s&&(o===i.category&&n===i.number&&r===i.order&&a===i.orderBy||this.fetchDownloads(),"downloads"!==i.type&&(this.fetchDownloads(),l||this.fetchDownloadTaxonomy({taxonomy:"download_category"}),this.props.setAttributes({orderBy:"date"}))),"download_categories"===s&&(l===i.showEmpty&&r===i.order&&a===i.orderBy||this.fetchDownloadTaxonomy({taxonomy:"download_category"}),"download_categories"!==i.type&&(this.fetchDownloadTaxonomy({taxonomy:"download_category"}),this.props.setAttributes({orderBy:"count"}))),"download_tags"===s&&(l===i.showEmpty&&r===i.order&&a===i.orderBy||this.fetchDownloadTaxonomy({taxonomy:"download_tag"}),"download_tags"!==i.type&&(this.fetchDownloadTaxonomy({taxonomy:"download_tag"}),this.props.setAttributes({orderBy:"count"}))),c||this.props.setAttributes({align:void 0})}},{key:"componentWillUnmount",value:function(){delete this.downloadsRequest,delete this.downloadCategoriesRequest,delete this.downloadTagsRequest}},{key:"getOrderOptions",value:function(){return[{value:"ASC",label:te("Ascending")},{value:"DESC",label:te("Descending")}]}},{key:"getOrderByOptions",value:function(){var e,t=this.props.attributes.type;return"downloads"===t?e=[{value:"date",label:te("Date Created")},{value:"earnings",label:te("Earnings")},{value:"id",label:te("ID")},{value:"price",label:te("Price")},{value:"random",label:te("Random")},{value:"sales",label:te("Sales")},{value:"name",label:te("Slug")},{value:"title",label:te("Title")}]:"download_categories"!==t&&"download_tags"!==t||(e=[{value:"count",label:te("Count")},{value:"id",label:te("ID")},{value:"name",label:te("Name")},{value:"slug",label:te("Slug")}]),e}},{key:"getDownloadCategories",value:function(){var e=this.state.downloadCategories,t=[{value:"all",label:te("All")}];return e.forEach((function(e){t.push({label:e.name,value:e.id})})),t}},{key:"getBlockTypes",value:function(){return[{value:"downloads",label:te("Downloads")},{value:"download_categories",label:te("Download Categories")},{value:"download_tags",label:te("Download Tags")}]}},{key:"setDownloadCategory",value:function(e){"all"===e&&(e=void 0),this.props.setAttributes({category:e})}},{key:"showDescription",value:function(){var e=this.state.showDescription;this.setState({showDescription:!e,showFullContent:e},(function(){this.props.setAttributes({showDescription:!e}),this.props.setAttributes({showFullContent:!1})}))}},{key:"showFullContent",value:function(){var e=this.state.showFullContent;this.setState({showFullContent:!e,showDescription:e},(function(){this.props.setAttributes({showFullContent:!e}),this.props.setAttributes({showDescription:!1})}))}},{key:"fetchDownloadTaxonomy",value:function(e){var t=this,o=this.props.attributes,n=o.showEmpty,r=o.order,a=o.orderBy,l=o.type,s=e.taxonomy,c=this.getOrderByOptions(),i={per_page:-1,orderby:e.orderBy?e.orderBy.toLowerCase():a.toLowerCase(),order:e.order?e.order.toLowerCase():r.toLowerCase()};("downloads"===l&&(i.orderby="name",i.order="asc"),"download_categories"===l||"download_tags"===l)&&(c.find((function(e){return e.value===a}))||(i.orderby="count"),i.hide_empty=!0!==n);var u=le({path:"/wp/v2/".concat(s,"?").concat(addQueryArgs(W({},i)))});"download_category"===s&&(u.then((function(e){t.downloadCategoriesRequest===u&&t.setState({downloadCategories:e,isLoading:!1})})),this.downloadCategoriesRequest=u),"download_tag"===s&&(u.then((function(e){t.downloadTagsRequest===u&&t.setState({downloadTags:e,isLoading:!1})})),this.downloadTagsRequest=u)}},{key:"fetchDownloads",value:function(){var e=this,t=this.getOrderByOptions(),o=this.props.attributes,n=o.category,r=o.number,a=o.order,l=o.orderBy,s=l;switch(s){case"id":s="ID";break;case"random":s="rand";break;default:s=l}var c={number:r,order:a,orderby:s};Object(g.isUndefined)(n)||(c.category=n);var i=edd_blocks_global_vars.url;t.find((function(e){return e.value===l}))||(c.orderby="date");var u=le({url:"".concat(i,"/?edd-api=products&").concat(W({},c))});u.then((function(t){e.downloadsRequest===u&&e.setState({downloads:t,isLoading:!1})})),this.downloadsRequest=u}},{key:"renderDownloads",value:function(){var e=this.state.downloads.products,t=this.state,o=t.downloadCategories,n=t.downloadTags,r=this.props.attributes,a=r.columns,l=r.type;return"downloads"===l?Object(y.createElement)("div",{className:O()("edd_downloads_list","edd_download_columns_"+a)},e.map((function(e){return Object(y.createElement)(H,{download:e,key:e.info.id.toString(),attributes:r})}))):"download_categories"===l?Object(y.createElement)("div",{className:O()("edd_downloads_list","edd-download-terms","edd_download_columns_"+a)},o.map((function(e){return Object(y.createElement)(U,{key:e.id,taxonomy:e,attributes:r})}))):"download_tags"===l?Object(y.createElement)("div",{className:O()("edd_downloads_list","edd-download-terms","edd_download_columns_"+a)},n.map((function(e){return Object(y.createElement)(U,{key:e.id,taxonomy:e,attributes:r})}))):void 0}},{key:"render",value:function(){var e,t,o=this.props,n=o.attributes,r=o.setAttributes,a=n.align,l=n.number,s=n.columns,c=n.showBuyButton,i=n.showPrice,u=n.showThumbnails,d=n.showDescription,p=n.showFullContent,w=n.showPagination,f=n.order,b=n.orderBy,h=n.category,m=n.type,g=n.showTitle,v=n.showCount,O=n.showEmpty,j=this.state,_=j.downloadTags,E=j.downloadCategories,C=j.isLoading,x=this.state.downloads.products,D="download_categories"===m||"download_tags"===m;if(e=te("downloads"===m?"Show Excerpt":"download_categories"===m?"Show Category Description":"download_tags"===m?"Show Tag Description":"Show Description"),t=te("download_categories"===m?"Loading download categories":"download_tags"===m?"Loading download tags":"Loading downloads"),C)return Object(y.createElement)(J,null,Object(y.createElement)(X,{icon:"download",label:t},Object(y.createElement)(ee,null)));var S=Object(y.createElement)(ne,null,Object(y.createElement)(V,{title:te("Settings")},Object(y.createElement)($,{label:te("Display"),value:m,options:this.getBlockTypes(),onChange:function(e){return r({type:e})}}),"downloads"===m&&Object(y.createElement)(Z,{label:te("Downloads Per Page"),value:l,onChange:function(e){return r({number:e})},min:1,max:100}),Object(y.createElement)(Z,{label:te("Columns"),value:s,onChange:function(e){return r({columns:e})},min:1,max:6}),"downloads"===m&&Object(y.createElement)(Y,{label:te("Show Buy Button"),checked:!!c,onChange:function(){return r({showBuyButton:!c})}}),"downloads"===m&&Object(y.createElement)(Y,{label:te("Show Price"),checked:!!i,onChange:function(){return r({showPrice:!i})}}),Object(y.createElement)(Y,{label:te("Show Thumbnails"),checked:!!u,onChange:function(){return r({showThumbnails:!u})}}),D&&Object(y.createElement)(Y,{label:te("download_categories"===m?"Show Category Name":"Show Tag Name"),checked:!!g,onChange:function(){return r({showTitle:!g})}}),Object(y.createElement)(Y,{label:e,checked:!!d,onChange:this.showDescription}),g&&D&&Object(y.createElement)(Y,{label:te("Show Count"),checked:!!v,onChange:function(){return r({showCount:!v})}}),D&&Object(y.createElement)(Y,{label:te("download_categories"===m?"Show Empty Categories":"Show Empty Tags"),checked:!!O,onChange:function(){return r({showEmpty:!O})}}),"downloads"===m&&Object(y.createElement)(Y,{label:te("Show Full Content"),checked:!!p,onChange:this.showFullContent}),"downloads"===m&&Object(y.createElement)(Y,{label:te("Show Pagination"),checked:!!w,onChange:function(){return r({showPagination:!w})}}),Object(y.createElement)($,{label:te("Order By"),value:b,options:this.getOrderByOptions(),onChange:function(e){return r({orderBy:e})}}),Object(y.createElement)($,{label:te("Order"),value:f,options:this.getOrderOptions(),onChange:function(e){return r({order:e})}}),"downloads"===m&&Object(y.createElement)($,{label:te("Show Downloads From Category"),value:h,options:this.getDownloadCategories(),onChange:this.setDownloadCategory}))),k=Array.isArray(x)&&x.length,T=Array.isArray(_)&&_.length,P=Array.isArray(E)&&E.length;return k||"downloads"!==m?P||"download_categories"!==m?T||"download_tags"!==m?Object(y.createElement)(J,null,S,Object(y.createElement)(re,null,Object(y.createElement)(ae,{value:a,onChange:function(e){return r({align:e})},controls:["wide","full"]})),Object(y.createElement)("div",{className:this.props.className},this.renderDownloads())):Object(y.createElement)(J,null,S,Object(y.createElement)(X,{icon:"download",label:te("Loading download tags")},Array.isArray(_)?te("No download tags found."):Object(y.createElement)(ee,null))):Object(y.createElement)(J,null,S,Object(y.createElement)(X,{icon:"download",label:te("Loading download categories")},Array.isArray(E)?te("No download categories found."):Object(y.createElement)(ee,null))):Object(y.createElement)(J,null,S,Object(y.createElement)(X,{icon:"download",label:te("Loading downloads")},Array.isArray(x)?te("No downloads found."):Object(y.createElement)(ee,null)))}}]),o}(G),ce=wp.i18n.__,ie="easydigitaldownloads/downloads",ue={title:ce("Downloads"),description:ce("Display Downloads, Categories and Tags from Easy Digital Downloads."),icon:"download",category:"widgets",keywords:[ce("downloads"),ce("edd")],supports:{html:!1,multiple:!0},getEditWrapperProps:function(e){var t=e.align;if(["wide","full"].includes(t))return{"data-align":t,"data-block-type":"easy-digital-downloads"}},edit:se,save:function(){return null}},de=wp.blocks.registerBlockType;[n].forEach((function(e){var t=e.name,o=e.settings;de(t,o)}))}]);
//# sourceMappingURL=main.js.map